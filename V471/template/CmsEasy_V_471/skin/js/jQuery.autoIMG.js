
(function($){var
tempPath='./images/loading.png',errorPath='./images/error.png',isMaxWidth='maxWidth'in document.documentElement.style,isIE7=!-[1,]&&!('prototype'in Image)&&isMaxWidth;new Image().src=tempPath;$.fn.autoIMG=function(){var $this=this,maxWidth=$this.width();return $this.find('img').each(function(i,img){if(isMaxWidth)return img.style.maxWidth=maxWidth+'px';var path=img.getAttribute('data-src')||img.src,next=img.nextSibling,parent=img.parentNode,temp=new Image();img.style.display='none';img.removeAttribute('src');img.parentNode.removeChild(img);temp.src=tempPath;next?next.insertBefore(temp):parent.appendChild(temp);imgReady(path,function(width,height){if(width>maxWidth){height=maxWidth/width*height,width=maxWidth;temp.parentNode.removeChild(temp);img.style.display='';img.style.width=width+'px';img.style.height=height+'px';img.setAttribute('src',path);next?next.insertBefore(img):parent.appendChild(img);};},function(){temp.src=errorPath;temp.title='Image load error!';});});};isIE7&&(function(c,d,s){s=d.createElement('style');d.getElementsByTagName('head')[0].appendChild(s);s.styleSheet&&(s.styleSheet.cssText+=c)||s.appendChild(d.createTextNode(c))})('img {-ms-interpolation-mode:bicubic}',document);(function(){var list=[],intervalId=null,tick=function(){var i=0;for(;i<list.length;i++){list[i].end?list.splice(i--,1):list[i]();};!list.length&&stop();},stop=function(){clearInterval(intervalId);intervalId=null;};this.imgReady=function(url,callback,error){var check,end,width,height,offsetWidth,offsetHeight,div,accuracy=1024,doc=document,container=doc.body||doc.getElementsByTagName('head')[0],img=new Image();img.src=url;if(!callback)return img;if(img.complete)return callback(img.width,img.height);div=doc.createElement('div');div.style.cssText='visibility:hidden;position:absolute;left:0;top:0;width:1px;height:1px;overflow:hidden';div.appendChild(img)
container.appendChild(div);width=img.offsetWidth;height=img.offsetHeight;img.onload=function(){end();callback(img.width,img.height);};img.onerror=function(){end();error&&error();};check=function(){offsetWidth=img.offsetWidth;offsetHeight=img.offsetHeight;if(offsetWidth!==width||offsetHeight!==height||offsetWidth*offsetHeight>accuracy){end();callback(offsetWidth,offsetHeight);};};check.url=url;end=function(){check.end=true;img.onload=img.onerror=null;div.innerHTML='';div.parentNode.removeChild(div);};!check.end&&check();for(var i=0;i<list.length;i++){if(list[i].url===url)return;};if(!check.end){list.push(check);if(!intervalId)intervalId=setInterval(tick,150);};};})();})(jQuery);